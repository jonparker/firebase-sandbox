<html>
  <head>
    <script src='https://cdn.firebase.com/v0/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
    <script type='text/javascript' src='https://cdn.firebase.com/v0/firebase-auth-client.js'></script>
    <script type='text/javascript' src='http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js'></script>
	
	<script type="text/javascript">
	
        var page = {};
        
		var viewModel =
        {
            email: ko.observable(),
            password: ko.observable(),
            message: ko.observable(),
            
            login: function()
            {
                page.authClient.login('password', { email: this.email(), password: this.password() });
            },
            facebookLogin: function()
            {
                page.authClient.login('facebook');
            },
            logout: function()
            {
                page.authClient.logout();
            },
            saveMessage: function(text)
            {
                page.firebase.child('text').set({ 'message': this.message() });
            },
            messages: ko.observableArray()
        };
		        
		$(document).ready(function()
		{
			var firebase = new Firebase('https://petitionm.firebaseio.com/');
			var authClient = new FirebaseAuthClient(firebase, function(error, data) {
			  if (error) {
				// an error occurred while attempting login
				console.log(error);
			  } else if (data) {
				// user authenticated with Firebase
				console.log('User ID: ' + data.id + ', Provider: ' + data.provider);
			  } else {
				// user is logged out
			  }
			});
			
			page.authClient = authClient;
			page.firebase = firebase;
            
            ko.applyBindings(viewModel);
		});
		
        /*
		fb.child('text').on('child_added', function(snapshot) {
			
		});
                    
		function ShowMessages(messages)
		{
			$("#messages").append('<span>' + messages + '</span>');
		}
                     */
	</script>
  </head>
<body>
	<div id="messages">
	</div>
	<input type="button" value="Login" data-bind="click: login" />
    <input type="button" value="Facebook Login" data-bind="click: facebookLogin" />
	<input type="button" value="Logout" data-bind="click: logout" />
	<input type="text" id="message" data-bind="value: message" />
	<input type="button" value="Save" data-bind="click: saveMessage" />
</body>
</html>
